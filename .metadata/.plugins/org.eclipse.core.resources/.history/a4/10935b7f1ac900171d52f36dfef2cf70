import java.io.File;
import javafx.event.ActionEvent;
import javafx.event.EventHandler;
import javafx.geometry.Insets;
import javafx.geometry.Pos;
import javafx.scene.Scene;
import javafx.scene.control.Button;
import javafx.scene.layout.BorderPane;
import javafx.scene.layout.GridPane;
import javafx.scene.layout.StackPane;
import javafx.scene.layout.VBox;
import javafx.scene.text.Text;
import javafx.stage.FileChooser;
import javafx.stage.Stage;

public class WelcomeStage {

	private Text fileName;

	public void setWelcomeStage(Stage stage) {
		StackPane rootPane = new StackPane();
		BorderPane mainPane = new BorderPane();
		mainPane.setPadding(new Insets(10, 20, 10, 20));
		
		VBox vbox = new VBox(20);
		mainPane.setTop(vbox);
		
		GridPane pane = new GridPane();
		pane.setHgap(10);
		pane.setVgap(10);
		pane.setAlignment(Pos.CENTER);
		
//		Label welcome = new Label("WELCOME TO PAYCHECKER");

		// Button to open a file
		Button chooseFile = new Button("Choose a File");
		chooseFile.setOnAction(new PaycheckFileReader());
		chooseFile.setAlignment(Pos.CENTER);

		// Button to Create an Employee Paycheck
		Button createPaycheck = new Button("Create Paycheck");
		createPaycheck.setOnAction(e -> createPaycheckClicked(stage));

		fileName = new Text("");

		pane.add(chooseFile, 0, 1);
		pane.add(fileName, 1, 1);
		pane.add(createPaycheck, 0, 2);
		Scene scene = new Scene(pane, 700, 500);
		new PrintPaycheck().setDialogStage(stage);

		stage.setScene(scene);
		stage.show();
	}

	// buttons on welcome stage
	public void createPaycheckClicked(Stage stage) {
		new CreatePaycheckStage().setCreatePaycheckStage(stage);
	}

	// Inner class of the button to read the file
	public class PaycheckFileReader implements EventHandler<ActionEvent> {

		private FileChooser fileChooser = new FileChooser();
		private File selectedFile;

		@Override
		public void handle(ActionEvent event) {

			try {
				selectFile();
				System.out.println("Reading file ...");
			} catch (Exception e) {
				System.out.println("Loading file canceled");
				fileName.setText("No file Selected.");
			}
		}

		public File getSelectedFile() {
			return selectedFile;
		}

		public void selectFile() {
			selectedFile = fileChooser.showOpenDialog(null);

			if (selectedFile != null) {
				fileName.setText("File selected: " + selectedFile.getName());
			} else {
				fileName.setText("No file Selected.");
			}

			new PaycheckFile().parseFile(selectedFile);

		}
	}

}
